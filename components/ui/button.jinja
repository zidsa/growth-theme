{# Base classes for all buttons #}
{% set base_classes = 'inline-flex rounded items-center justify-center gap-2 whitespace-nowrap font-normal transition-all disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2' %}

{# Variant lookup #}
{%
  set variants = {
    'filled': 'outline outline-1 outline-foreground text-primary-foreground bg-foreground hover:outline-2 hover:bg-foreground/90 active:outline-2 active:bg-foreground/80 disabled:outline-border-disabled disabled:bg-secondary disabled:text-muted',
    'outlined': 'outline outline-1 outline-foreground text-foreground bg-background hover:outline-2 active:outline-2 active:bg-secondary disabled:outline-border-disabled disabled:text-muted',
    'text': 'text-foreground bg-transparent hover:outline hover:outline-1 hover:outline-foreground active:bg-secondary disabled:text-muted'
  }
%}

{# Size lookup #}
{%
  set sizes = {
    'lg': 'px-4 py-3 text-body1',
    'md': 'px-4 py-2 text-body2',
    'sm': 'px-2 py-1.5 text-caption',
    'icon-md': 'size-10 p-2.5',
    'icon-sm': 'size-8 p-2'
  }
%}

{# Get variant and size classes #}
{% set current_size = size|default('lg') %}
{% set variant_classes = variants[variant|default('filled')] %}
{% set size_classes = sizes[current_size] %}

{# Override variant for icon buttons #}
{% if current_size.startswith('icon-') %}
  {% set variant_classes = 'text-foreground disabled:text-muted' %}
{% endif %}

{# Combine all classes #}
{% set class_names = base_classes + ' ' + variant_classes + ' ' + size_classes + ' ' + (class|default('')) %}

{# Render as link or button #}
{% if href %}
  <a
    href="{{ href }}"
    class="{{ class_names }}"
    {% if aria_label %}aria-label="{{ aria_label }}"{% endif %}
    {{ attrs|default('')|safe }}
  >
    {{ content|safe }}
  </a>
{% else %}
  <button
    type="{{ type|default('button') }}"
    class="{{ class_names }}"
    {% if disabled %}disabled{% endif %}
    {% if aria_label %}aria-label="{{ aria_label }}"{% endif %}
    {{ attrs|default('')|safe }}
  >
    {{ content|safe }}
  </button>
{% endif %}
