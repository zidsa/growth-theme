{% set disclosure_id = id | default('disclosure-' ~ range(1000, 9999)|random) %}
{% set is_open = open | default(false) %}
{% set allow_multi = multi | default(true) %}
{% set input_type = 'checkbox' if allow_multi else 'radio' %}
{% set radio_name = group if not allow_multi else '' %}

<div class="disclosure-wrapper {{ class | default('') }}">
  {# Hidden Input for State (Checkbox or Radio) #}
  <input
    type="{{ input_type }}"
    id="{{ disclosure_id }}"
    {% if not allow_multi %}name="{{ radio_name }}"{% endif %}
    class="peer hidden"
    {% if is_open %}checked{% endif %}
  />

  {# Toggle Label/Button #}
  <label
    for="{{ disclosure_id }}"
    class="{{ button_class | default('') }} flex w-full cursor-pointer items-center justify-between gap-3 peer-checked:[&_svg]:rotate-0"
  >
    {# Title #}
    <span class="text-foreground text-h6"> {{ title }} </span>

    {# Arrow Icon - rotates when checked #}
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      class="text-foreground flex-shrink-0 rotate-180 transition-transform duration-200"
    >
      <path
        d="M11.999 8.70312C12.0929 8.70312 12.1689 8.73142 12.249 8.81152L17.1924 13.7559C17.2744 13.8378 17.3008 13.9117 17.3008 13.999C17.3008 14.0863 17.2743 14.1602 17.1924 14.2422C17.1143 14.3202 17.0374 14.3506 16.9365 14.3506C16.8359 14.3505 16.7596 14.32 16.6816 14.2422L16.6807 14.2412L12.3516 9.9375L11.998 9.58594L7.31738 14.2666C7.23964 14.3443 7.17341 14.3662 7.09277 14.3633C6.99851 14.3598 6.91711 14.3282 6.83105 14.2422C6.75294 14.1641 6.72266 14.0872 6.72266 13.9863C6.72267 13.8854 6.75294 13.8086 6.83105 13.7305L11.75 8.81152C11.83 8.73152 11.9054 8.7032 11.999 8.70312Z"
        fill="currentColor"
        stroke="currentColor"
      ></path>
    </svg>
  </label>

  {# Disclosure Content with Grid Animation #}
  <div
    class="grid [grid-template-rows:0fr] overflow-hidden transition-[grid-template-rows] duration-200 ease-out peer-checked:[grid-template-rows:1fr]"
  >
    <div class="min-h-0 overflow-hidden">
      <div class="{{ content_class | default('') }} px-4 pt-4">{{ content | safe }}</div>
    </div>
  </div>
</div>
