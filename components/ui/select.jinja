{#
  Select Component

  A native select dropdown with optional icons.

  Parameters:
    - name: (string) Select name attribute
    - id: (string) Select ID. Auto-generated if not provided
    - value: (string) Selected value
    - placeholder: (string) Placeholder option text
    - options: (array) Array of {value, label, disabled?, selected?} objects
    - required: (boolean) Makes the select required
    - disabled: (boolean) Disables the select
    - multiple: (boolean) Allow multiple selections
    - autocomplete: (string) Autocomplete attribute
    - caption: (string) Helper text below select
    - error: (boolean) Error state
    - error_message: (string) Error message (replaces caption when error)
    - wrapper_class: (string) Additional classes for wrapper div
    - select_class: (string) Additional classes for select element
    - attrs: (string) Additional HTML attributes for select

  Usage:
    {% set options = [
      {'value': 'sm', 'label': 'Small'},
      {'value': 'md', 'label': 'Medium'},
      {'value': 'lg', 'label': 'Large'}
    ] %}

    <div class="grid w-full items-center gap-2">
      {% with for="size", content=_("Size"), required=true %}
        {% include 'components/ui/label.jinja' %}
      {% endwith %}
      {% with id="size", name="size", options=options, placeholder=_("Select size") %}
        {% include 'components/ui/select.jinja' %}
      {% endwith %}
    </div>
#}

{% set select_id = id|default(name ~ '-' ~ range(1000, 9999)|random) %}

<div class="{{ wrapper_class|default('') }}">
  {# Select Container #}
  <div
    class="{{- ' border-destructive border-2' if error else ' border-muted' }} {{- ' hover:border-2' if not disabled and not error }} {{- ' focus-within:border-foreground focus-within:border-2' if not error }} {{- ' bg-background-disabled border-border-disabled' if disabled else '' }} relative flex h-12 items-center gap-3 rounded border px-3 transition-[border-color,border-width]"
    {% if disabled %}data-disabled="true"{% endif %}
    {% if error %}data-error="true"{% endif %}
  >
    {# Select #}
    <select
      id="{{ select_id }}"
      {% if name %}name="{{ name }}"{% endif %}
      {% if required %}required{% endif %}
      {% if disabled %}disabled{% endif %}
      {% if autocomplete %}autocomplete="{{ autocomplete }}"{% endif %}
      {% if multiple %}multiple{% endif %}
      {% if error %}aria-invalid="true"{% endif %}
      class="text-foreground {{ select_class|default('') }} text-body1 disabled:text-muted h-full w-full flex-1 appearance-none bg-transparent outline-none disabled:cursor-not-allowed"
      {{ attrs|default('')|safe }}
    >
      {# Placeholder option #}
      {% if placeholder %}
        <option
          value=""
          disabled
          {% if not value %}selected{% endif %}
        >
          {{ placeholder }}
        </option>
      {% endif %}

      {# Options #}
      {% if options is defined and options is iterable and options is not string %}
        {% for option in options %}
          <option
            value="{{ option.value }}"
            {% if value == option.value or (option.selected|default(false)) %}selected{% endif %}
            {% if option.disabled|default(false) %}disabled{% endif %}
            {{ option.attrs|default('')|safe }}
          >
            {{ option.label }}
          </option>
        {% endfor %}
      {% endif %}
    </select>

    {# Dropdown Icon #}
    <div class="{{ 'text-muted' if disabled else 'text-foreground' }} pointer-events-none shrink-0">
      <svg
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
      >
        <path
          d="M6 9L12 15L18 9"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        ></path>
      </svg>
    </div>
  </div>

  {# Caption / Error Message #}
  {% if caption or error_message %}
    <p class="{{ 'text-destructive' if error else 'text-muted' }} text-caption mt-2">
      {{ error_message if error and error_message else caption }}
    </p>
  {% endif %}
</div>
